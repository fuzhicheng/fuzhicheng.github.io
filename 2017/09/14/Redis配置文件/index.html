<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="yanm1ng&#39;s blog">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      Redis配置文件 | FF
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>FF</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Redis配置文件</h2>
  <p class="post-date">2017-09-14</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body">
  <article class="post-article">
    <section class="markdown-content"><blockquote>
<p>Redis 配置文件示例</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div></pre></td><td class="code"><pre><div class="line"># 注意单位: 当需要配置内存大小时, 可能需要指定像1k,5GB,4M等常见格式</div><div class="line">#</div><div class="line"># 1k =&gt; 1000 bytes</div><div class="line"># 1kb =&gt; 1024 bytes</div><div class="line"># 1m =&gt; 1000000 bytes</div><div class="line"># 1mb =&gt; 1024*1024 bytes</div><div class="line"># 1g =&gt; 1000000000 bytes</div><div class="line"># 1gb =&gt; 1024*1024*1024 bytes</div><div class="line">#</div><div class="line"># 单位是对大小写不敏感的 1GB 1Gb 1gB 是相同的。</div><div class="line"></div><div class="line">################################## INCLUDES ###################################</div><div class="line"></div><div class="line"># 可以在这里包含一个或多个其他的配置文件。如果你有一个适用于所有Redis服务器的标准配置模板</div><div class="line"># 但也需要一些每个服务器自定义的设置，这个功能将很有用。被包含的配置文件也可以包含其他配置文件，</div><div class="line"># 所以需要谨慎的使用这个功能。</div><div class="line">#</div><div class="line"># 注意“inclue”选项不能被admin或Redis哨兵的&quot;CONFIG REWRITE&quot;命令重写。</div><div class="line"># 因为Redis总是使用最后解析的配置行最为配置指令的值, 你最好在这个文件的开头配置includes来</div><div class="line"># 避免它在运行时重写配置。</div><div class="line"># 如果相反你想用includes的配置覆盖原来的配置，你最好在该文件的最后使用include</div><div class="line">#</div><div class="line"># include /path/to/local.conf</div><div class="line"># include /path/to/other.conf</div><div class="line"></div><div class="line">################################ GENERAL  #####################################</div><div class="line"></div><div class="line"># 默认Rdis不会作为守护进程运行。如果需要的话配置成&apos;yes&apos;</div><div class="line"># 注意配置成守护进程后Redis会将进程号写入文件/var/run/redis.pid</div><div class="line">daemonize no</div><div class="line"></div><div class="line"># 当以守护进程方式运行时，默认Redis会把进程ID写到 /var/run/redis.pid。你可以在这里修改路径。</div><div class="line">pidfile /var/run/redis.pid</div><div class="line"></div><div class="line"># 接受连接的特定端口，默认是6379</div><div class="line"># 如果端口设置为0，Redis就不会监听TCP套接字。</div><div class="line">port 6379</div><div class="line"></div><div class="line"># TCP listen() backlog.</div><div class="line">#</div><div class="line"># 在高并发环境下你需要一个高backlog值来避免慢客户端连接问题。注意Linux内核默默地将这个值减小</div><div class="line"># 到/proc/sys/net/core/somaxconn的值，所以需要确认增大somaxconn和tcp_max_syn_backlog</div><div class="line"># 两个值来达到想要的效果。</div><div class="line">tcp-backlog 511</div><div class="line"></div><div class="line"># 默认Redis监听服务器上所有可用网络接口的连接。可以用&quot;bind&quot;配置指令跟一个或多个ip地址来实现</div><div class="line"># 监听一个或多个网络接口</div><div class="line">#</div><div class="line"># 示例:</div><div class="line">#</div><div class="line"># bind 192.168.1.100 10.0.0.1</div><div class="line"># bind 127.0.0.1</div><div class="line"></div><div class="line"># 指定用来监听Unix套套接字的路径。没有默认值， 所以在没有指定的情况下Redis不会监听Unix套接字</div><div class="line">#</div><div class="line"># unixsocket /tmp/redis.sock</div><div class="line"># unixsocketperm 755</div><div class="line"></div><div class="line"># 一个客户端空闲多少秒后关闭连接。(0代表禁用，永不关闭)</div><div class="line">timeout 0</div><div class="line"></div><div class="line"># TCP keepalive.</div><div class="line">#</div><div class="line"># 如果非零，则设置SO_KEEPALIVE选项来向空闲连接的客户端发送ACK，由于以下两个原因这是很有用的：</div><div class="line">#</div><div class="line"># 1）能够检测无响应的对端</div><div class="line"># 2）让该连接中间的网络设备知道这个连接还存活</div><div class="line">#</div><div class="line"># 在Linux上，这个指定的值(单位：秒)就是发送ACK的时间间隔。</div><div class="line"># 注意：要关闭这个连接需要两倍的这个时间值。</div><div class="line"># 在其他内核上这个时间间隔由内核配置决定</div><div class="line">#</div><div class="line"># 这个选项的一个合理值是60秒</div><div class="line">tcp-keepalive 0</div><div class="line"></div><div class="line"># 指定服务器调试等级</div><div class="line"># 可能值：</div><div class="line"># debug （大量信息，对开发/测试有用）</div><div class="line"># verbose （很多精简的有用信息，但是不像debug等级那么多）</div><div class="line"># notice （适量的信息，基本上是你生产环境中需要的）</div><div class="line"># warning （只有很重要/严重的信息会记录下来）</div><div class="line">loglevel notice</div><div class="line"></div><div class="line"># 指明日志文件名。也可以使用&quot;stdout&quot;来强制让Redis把日志信息写到标准输出上。</div><div class="line"># 注意:如果Redis以守护进程方式运行，而设置日志显示到标准输出的话，日志会发送到/dev/null</div><div class="line">logfile &quot;&quot;</div><div class="line"></div><div class="line"># 要使用系统日志记录器，只要设置 &quot;syslog-enabled&quot; 为 &quot;yes&quot; 就可以了。</div><div class="line"># 然后根据需要设置其他一些syslog参数就可以了。</div><div class="line"># syslog-enabled no</div><div class="line"></div><div class="line"># 指明syslog身份</div><div class="line"># syslog-ident redis</div><div class="line"></div><div class="line"># 指明syslog的设备。必须是user或LOCAL0 ~ LOCAL7之一。</div><div class="line"># syslog-facility local0</div><div class="line"></div><div class="line"># 设置数据库个数。默认数据库是 DB 0，</div><div class="line"># 可以通过select &lt;dbid&gt;  (0 &lt;= dbid &lt;= &apos;databases&apos; - 1 ）来为每个连接使用不同的数据库。</div><div class="line">databases 16</div><div class="line"></div><div class="line">################################ SNAPSHOTTING  ################################</div><div class="line">#</div><div class="line"># 把数据库存到磁盘上:</div><div class="line">#</div><div class="line">#   save &lt;seconds&gt; &lt;changes&gt;</div><div class="line">#   </div><div class="line">#   会在指定秒数和数据变化次数之后把数据库写到磁盘上。</div><div class="line">#</div><div class="line">#   下面的例子将会进行把数据写入磁盘的操作:</div><div class="line">#   900秒（15分钟）之后，且至少1次变更</div><div class="line">#   300秒（5分钟）之后，且至少10次变更</div><div class="line">#   60秒之后，且至少10000次变更</div><div class="line">#</div><div class="line">#   注意：你要想不写磁盘的话就把所有 &quot;save&quot; 设置注释掉就行了。</div><div class="line">#</div><div class="line">#   通过添加一条带空字符串参数的save指令也能移除之前所有配置的save指令</div><div class="line">#   像下面的例子：</div><div class="line">#   save &quot;&quot; </div><div class="line"></div><div class="line">save 900 1</div><div class="line">save 300 10</div><div class="line">save 60 10000</div><div class="line"></div><div class="line"># 默认如果开启RDB快照(至少一条save指令)并且最新的后台保存失败，Redis将会停止接受写操作</div><div class="line"># 这将使用户知道数据没有正确的持久化到硬盘，否则可能没人注意到并且造成一些灾难。</div><div class="line">#</div><div class="line"># 如果后台保存进程能重新开始工作，Redis将自动允许写操作</div><div class="line">#</div><div class="line"># 然而如果你已经部署了适当的Redis服务器和持久化的监控，你可能想关掉这个功能以便于即使是</div><div class="line"># 硬盘，权限等出问题了Redis也能够像平时一样正常工作，</div><div class="line">stop-writes-on-bgsave-error yes</div><div class="line"></div><div class="line"># 当导出到 .rdb 数据库时是否用LZF压缩字符串对象？</div><div class="line"># 默认设置为 &quot;yes&quot;，因为几乎在任何情况下它都是不错的。</div><div class="line"># 如果你想节省CPU的话你可以把这个设置为 &quot;no&quot;，但是如果你有可压缩的key和value的话，</div><div class="line"># 那数据文件就会更大了。</div><div class="line">rdbcompression yes</div><div class="line"></div><div class="line"># 因为版本5的RDB有一个CRC64算法的校验和放在了文件的最后。这将使文件格式更加可靠但在</div><div class="line"># 生产和加载RDB文件时，这有一个性能消耗(大约10%)，所以你可以关掉它来获取最好的性能。</div><div class="line">#</div><div class="line"># 生成的关闭校验的RDB文件有一个0的校验和，它将告诉加载代码跳过检查</div><div class="line">rdbchecksum yes</div><div class="line"></div><div class="line"># 持久化数据库的文件名</div><div class="line">dbfilename dump.rdb</div><div class="line"></div><div class="line"># 工作目录</div><div class="line">#</div><div class="line"># 数据库会写到这个目录下，文件名就是上面的 &quot;dbfilename&quot; 的值。</div><div class="line"># </div><div class="line"># 累加文件也放这里。</div><div class="line"># </div><div class="line"># 注意你这里指定的必须是目录，不是文件名。</div><div class="line">dir ./</div><div class="line"></div><div class="line">################################# REPLICATION #################################</div><div class="line"># 主从同步。通过 slaveof 指令来实现Redis实例的备份。</div><div class="line"># 注意，这里是本地从远端复制数据。也就是说，本地可以有不同的数据库文件、绑定不同的IP、监听</div><div class="line"># 不同的端口。</div><div class="line">#</div><div class="line"># slaveof &lt;masterip&gt; &lt;masterport&gt;</div><div class="line"></div><div class="line"># 如果master设置了密码保护（通过 &quot;requirepass&quot; 选项来配置），那么slave在开始同步之前必须</div><div class="line"># 进行身份验证，否则它的同步请求会被拒绝。</div><div class="line">#</div><div class="line"># masterauth &lt;master-password&gt;</div><div class="line"></div><div class="line"># 当一个slave失去和master的连接，或者同步正在进行中，slave的行为有两种可能：</div><div class="line">#</div><div class="line"># 1) 如果 slave-serve-stale-data 设置为 &quot;yes&quot; (默认值)，slave会继续响应客户端请求，</div><div class="line">#    可能是正常数据，也可能是还没获得值的空数据。</div><div class="line"># 2) 如果 slave-serve-stale-data 设置为 &quot;no&quot;，slave会回复&quot;正在从master同步</div><div class="line">#   （SYNC with master in progress）&quot;来处理各种请求，除了 INFO 和 SLAVEOF 命令。</div><div class="line">#</div><div class="line">slave-serve-stale-data yes</div><div class="line"></div><div class="line"># 你可以配置salve实例是否接受写操作。可写的slave实例可能对存储临时数据比较有用(因为写入salve</div><div class="line"># 的数据在同master同步之后将很容被删除)，但是如果客户端由于配置错误在写入时也可能产生一些问题。</div><div class="line">#</div><div class="line"># 从Redis2.6默认所有的slave为只读</div><div class="line">#</div><div class="line"># 注意:只读的slave不是为了暴露给互联网上不可信的客户端而设计的。它只是一个防止实例误用的保护层。</div><div class="line"># 一个只读的slave支持所有的管理命令比如config,debug等。为了限制你可以用&apos;rename-command&apos;来</div><div class="line"># 隐藏所有的管理和危险命令来增强只读slave的安全性</div><div class="line">slave-read-only yes</div><div class="line"></div><div class="line"># slave根据指定的时间间隔向master发送ping请求。</div><div class="line"># 时间间隔可以通过 repl_ping_slave_period 来设置。</div><div class="line"># 默认10秒。</div><div class="line">#</div><div class="line"># repl-ping-slave-period 10</div><div class="line"></div><div class="line"># 以下选项设置同步的超时时间</div><div class="line">#</div><div class="line"># 1）slave在与master SYNC期间有大量数据传输，造成超时</div><div class="line"># 2）在slave角度，master超时，包括数据、ping等</div><div class="line"># 3）在master角度，slave超时，当master发送REPLCONF ACK pings</div><div class="line"># </div><div class="line"># 确保这个值大于指定的repl-ping-slave-period，否则在主从间流量不高时每次都会检测到超时</div><div class="line">#</div><div class="line"># repl-timeout 60</div><div class="line"></div><div class="line"># 是否在slave套接字发送SYNC之后禁用 TCP_NODELAY ？</div><div class="line">#</div><div class="line"># 如果你选择“yes”Redis将使用更少的TCP包和带宽来向slaves发送数据。但是这将使数据传输到slave</div><div class="line"># 上有延迟，Linux内核的默认配置会达到40毫秒</div><div class="line">#</div><div class="line"># 如果你选择了 &quot;no&quot; 数据传输到salve的延迟将会减少但要使用更多的带宽</div><div class="line">#</div><div class="line"># 默认我们会为低延迟做优化，但高流量情况或主从之间的跳数过多时，把这个选项设置为“yes”</div><div class="line"># 是个不错的选择。</div><div class="line">repl-disable-tcp-nodelay no</div><div class="line"></div><div class="line"># 设置数据备份的backlog大小。backlog是一个slave在一段时间内断开连接时记录salve数据的缓冲，</div><div class="line"># 所以一个slave在重新连接时，不必要全量的同步，而是一个增量同步就足够了，将在断开连接的这段</div><div class="line"># 时间内slave丢失的部分数据传送给它。</div><div class="line">#</div><div class="line"># 同步的backlog越大，slave能够进行增量同步并且允许断开连接的时间就越长。</div><div class="line">#</div><div class="line"># backlog只分配一次并且至少需要一个slave连接</div><div class="line">#</div><div class="line"># repl-backlog-size 1mb</div><div class="line"></div><div class="line"># 当master在一段时间内不再与任何slave连接，backlog将会释放。以下选项配置了从最后一个</div><div class="line"># slave断开开始计时多少秒后，backlog缓冲将会释放。</div><div class="line">#</div><div class="line"># 0表示永不释放backlog</div><div class="line">#</div><div class="line"># repl-backlog-ttl 3600</div><div class="line"></div><div class="line"># slave的优先级是一个整数展示在Redis的Info输出中。如果master不再正常工作了，哨兵将用它来</div><div class="line"># 选择一个slave提升=升为master。</div><div class="line">#</div><div class="line"># 优先级数字小的salve会优先考虑提升为master，所以例如有三个slave优先级分别为10，100，25，</div><div class="line"># 哨兵将挑选优先级最小数字为10的slave。</div><div class="line">#</div><div class="line"># 0作为一个特殊的优先级，标识这个slave不能作为master，所以一个优先级为0的slave永远不会被</div><div class="line"># 哨兵挑选提升为master</div><div class="line">#</div><div class="line"># 默认优先级为100</div><div class="line">slave-priority 100</div><div class="line"></div><div class="line"># 如果master少于N个延时小于等于M秒的已连接slave，就可以停止接收写操作。</div><div class="line">#</div><div class="line"># N个slave需要是“oneline”状态</div><div class="line">#</div><div class="line"># 延时是以秒为单位，并且必须小于等于指定值，是从最后一个从slave接收到的ping（通常每秒发送）</div><div class="line"># 开始计数。</div><div class="line">#</div><div class="line"># This option does not GUARANTEES that N replicas will accept the write, but</div><div class="line"># will limit the window of exposure for lost writes in case not enough slaves</div><div class="line"># are available, to the specified number of seconds.</div><div class="line">#</div><div class="line"># 例如至少需要3个延时小于等于10秒的slave用下面的指令：</div><div class="line">#</div><div class="line"># min-slaves-to-write 3</div><div class="line"># min-slaves-max-lag 10</div><div class="line">#</div><div class="line"># 两者之一设置为0将禁用这个功能。</div><div class="line">#</div><div class="line"># 默认 min-slaves-to-write 值是0（该功能禁用）并且 min-slaves-max-lag 值是10。</div><div class="line"></div><div class="line">################################## SECURITY ###################################</div><div class="line"></div><div class="line"># 要求客户端在处理任何命令时都要验证身份和密码。</div><div class="line"># 这个功能在有你不信任的其它客户端能够访问redis服务器的环境里非常有用。</div><div class="line">#</div><div class="line"></div><div class="line"># 为了向后兼容的话这段应该注释掉。而且大多数人不需要身份验证(例如:它们运行在自己的服务器上)</div><div class="line"># </div><div class="line"># 警告：因为Redis太快了，所以外面的人可以尝试每秒150k的密码来试图破解密码。这意味着你需要</div><div class="line"># 一个高强度的密码，否则破解太容易了。</div><div class="line">#</div><div class="line"># requirepass foobared</div><div class="line"></div><div class="line"># 命令重命名</div><div class="line">#</div><div class="line"># 在共享环境下，可以为危险命令改变名字。比如，你可以为 CONFIG 改个其他不太容易猜到的名字，</div><div class="line"># 这样内部的工具仍然可以使用，而普通的客户端将不行。</div><div class="line">#</div><div class="line"># 例如：</div><div class="line">#</div><div class="line"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</div><div class="line">#</div><div class="line"># 也可以通过改名为空字符串来完全禁用一个命令</div><div class="line">#</div><div class="line"># rename-command CONFIG &quot;&quot;</div><div class="line">#</div><div class="line"># 请注意：改变命令名字被记录到AOF文件或被传送到从服务器可能产生问题。</div><div class="line"></div><div class="line">################################### LIMITS ####################################</div><div class="line"></div><div class="line"># 设置最多同时连接的客户端数量。默认这个限制是10000个客户端，然而如果Redis服务器不能配置</div><div class="line"># 处理文件的限制数来满足指定的值，那么最大的客户端连接数就被设置成当前文件限制数减32（因</div><div class="line"># 为Redis服务器保留了一些文件描述符作为内部使用）</div><div class="line">#</div><div class="line"># 一旦达到这个限制，Redis会关闭所有新连接并发送错误&apos;max number of clients reached&apos;</div><div class="line">#</div><div class="line"># maxclients 10000</div><div class="line"></div><div class="line"># 不要用比设置的上限更多的内存。一旦内存使用达到上限，Redis会根据选定的回收策略（参见：</div><div class="line"># maxmemmory-policy）删除key</div><div class="line">#</div><div class="line"># 如果因为删除策略Redis无法删除key，或者策略设置为 &quot;noeviction&quot;，Redis会回复需要更</div><div class="line"># 多内存的错误信息给命令。例如，SET,LPUSH等等，但是会继续响应像Get这样的只读命令。</div><div class="line">#</div><div class="line"># 在使用Redis作为LRU缓存，或者为实例设置了硬性内存限制的时候（使用 &quot;noeviction&quot; 策略）</div><div class="line"># 的时候，这个选项通常事很有用的。</div><div class="line">#</div><div class="line"># 警告：当有多个slave连上达到内存上限的实例时，master为同步slave的输出缓冲区所需</div><div class="line"># 内存不计算在使用内存中。这样当驱逐key时，就不会因网络问题 / 重新同步事件触发驱逐key</div><div class="line"># 的循环，反过来slaves的输出缓冲区充满了key被驱逐的DEL命令，这将触发删除更多的key，</div><div class="line"># 直到这个数据库完全被清空为止</div><div class="line"># </div><div class="line"># 总之...如果你需要附加多个slave，建议你设置一个稍小maxmemory限制，这样系统就会有空闲</div><div class="line"># 的内存作为slave的输出缓存区(但是如果最大内存策略设置为&quot;noeviction&quot;的话就没必要了)</div><div class="line">#</div><div class="line"># maxmemory &lt;bytes&gt;</div><div class="line"></div><div class="line"># 最大内存策略：如果达到内存限制了，Redis如何选择删除key。你可以在下面五个行为里选：</div><div class="line"># </div><div class="line"># volatile-lru -&gt; 根据LRU算法生成的过期时间来删除。</div><div class="line"># allkeys-lru -&gt; 根据LRU算法删除任何key。</div><div class="line"># volatile-random -&gt; 根据过期设置来随机删除key。 </div><div class="line"># allkeys-&gt;random -&gt; 无差别随机删。 </div><div class="line"># volatile-ttl -&gt; 根据最近过期时间来删除（辅以TTL） </div><div class="line"># noeviction -&gt; 谁也不删，直接在写操作时返回错误。</div><div class="line"># </div><div class="line"># 注意：对所有策略来说，如果Redis找不到合适的可以删除的key都会在写操作时返回一个错误。</div><div class="line">#</div><div class="line"></div><div class="line">#       目前为止涉及的命令：set setnx setex append</div><div class="line">#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd</div><div class="line">#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby</div><div class="line">#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby</div><div class="line">#       getset mset msetnx exec sort</div><div class="line">#</div><div class="line"></div><div class="line"># 默认值如下：</div><div class="line">#</div><div class="line"># maxmemory-policy volatile-lru</div><div class="line"></div><div class="line"># LRU和最小TTL算法的实现都不是很精确，但是很接近（为了省内存），所以你可以用样本量做检测。</div><div class="line"># 例如：默认Redis会检查3个key然后取最旧的那个，你可以通过下面的配置指令来设置样本的个数。</div><div class="line">#</div><div class="line"># maxmemory-samples 3</div><div class="line"></div><div class="line">############################## APPEND ONLY MODE ###############################</div><div class="line"></div><div class="line"># 默认情况下，Redis是异步的把数据导出到磁盘上。这种模式在很多应用里已经足够好，但Redis进程</div><div class="line"># 出问题或断电时可能造成一段时间的写操作丢失(这取决于配置的save指令)。</div><div class="line">#</div><div class="line"># AOF是一种提供了更可靠的替代持久化模式，例如使用默认的数据写入文件策略（参见后面的配置）</div><div class="line"># 在遇到像服务器断电或单写情况下Redis自身进程出问题但操作系统仍正常运行等突发事件时，Redis</div><div class="line"># 能只丢失1秒的写操作。</div><div class="line">#</div><div class="line"># AOF和RDB持久化能同时启动并且不会有问题。</div><div class="line"># 如果AOF开启，那么在启动时Redis将加载AOF文件，它更能保证数据的可靠性。</div><div class="line">#</div><div class="line"># 请查看 http://redis.io/topics/persistence 来获取更多信息.</div><div class="line"></div><div class="line">appendonly no</div><div class="line"></div><div class="line"># 纯累加文件名字（默认：&quot;appendonly.aof&quot;）</div><div class="line"></div><div class="line">appendfilename &quot;appendonly.aof&quot;</div><div class="line"></div><div class="line"># fsync() 系统调用告诉操作系统把数据写到磁盘上，而不是等更多的数据进入输出缓冲区。</div><div class="line"># 有些操作系统会真的把数据马上刷到磁盘上；有些则会尽快去尝试这么做。</div><div class="line">#</div><div class="line"># Redis支持三种不同的模式：</div><div class="line">#</div><div class="line"># no：不要立刻刷，只有在操作系统需要刷的时候再刷。比较快。</div><div class="line"># always：每次写操作都立刻写入到aof文件。慢，但是最安全。</div><div class="line"># everysec：每秒写一次。折中方案。 </div><div class="line">#</div><div class="line"># 默认的 &quot;everysec&quot; 通常来说能在速度和数据安全性之间取得比较好的平衡。根据你的理解来</div><div class="line"># 决定，如果你能放宽该配置为&quot;no&quot; 来获取更好的性能(但如果你能忍受一些数据丢失，可以考虑使用</div><div class="line"># 默认的快照持久化模式)，或者相反，用“always”会比较慢但比everysec要更安全。</div><div class="line">#</div><div class="line"># 请查看下面的文章来获取更多的细节</div><div class="line"># http://antirez.com/post/redis-persistence-demystified.html </div><div class="line"># </div><div class="line"># 如果不能确定，就用 &quot;everysec&quot;</div><div class="line"></div><div class="line"># appendfsync always</div><div class="line">appendfsync everysec</div><div class="line"># appendfsync no</div><div class="line"></div><div class="line"># 如果AOF的同步策略设置成 &quot;always&quot; 或者 &quot;everysec&quot;，并且后台的存储进程（后台存储或写入AOF</div><div class="line"># 日志）会产生很多磁盘I/O开销。某些Linux的配置下会使Redis因为 fsync()系统调用而阻塞很久。</div><div class="line"># 注意，目前对这个情况还没有完美修正，甚至不同线程的 fsync() 会阻塞我们同步的write(2)调用。</div><div class="line">#</div><div class="line"># 为了缓解这个问题，可以用下面这个选项。它可以在 BGSAVE 或 BGREWRITEAOF 处理时阻止fsync()。</div><div class="line"># </div><div class="line"># 这就意味着如果有子进程在进行保存操作，那么Redis就处于&quot;不可同步&quot;的状态。</div><div class="line"># 这实际上是说，在最差的情况下可能会丢掉30秒钟的日志数据。（默认Linux设定）</div><div class="line"># </div><div class="line"># 如果把这个设置成&quot;yes&quot;带来了延迟问题，就保持&quot;no&quot;，这是保存持久数据的最安全的方式。</div><div class="line"></div><div class="line">no-appendfsync-on-rewrite no</div><div class="line"></div><div class="line"># 自动重写AOF文件</div><div class="line"># 如果AOF日志文件增大到指定百分比，Redis能够通过 BGREWRITEAOF 自动重写AOF日志文件。</div><div class="line"># </div><div class="line"># 工作原理：Redis记住上次重写时AOF文件的大小（如果重启后还没有写操作，就直接用启动时的AOF大小）</div><div class="line"># </div><div class="line"># 这个基准大小和当前大小做比较。如果当前大小超过指定比例，就会触发重写操作。你还需要指定被重写</div><div class="line"># 日志的最小尺寸，这样避免了达到指定百分比但尺寸仍然很小的情况还要重写。</div><div class="line">#</div><div class="line"># 指定百分比为0会禁用AOF自动重写特性。</div><div class="line"></div><div class="line">auto-aof-rewrite-percentage 100</div><div class="line">auto-aof-rewrite-min-size 64mb</div><div class="line"></div><div class="line">################################ LUA SCRIPTING  ###############################</div><div class="line"></div><div class="line"># Lua 脚本的最大执行时间，毫秒为单位</div><div class="line">#</div><div class="line"># 如果达到了最大的执行时间，Redis将要记录在达到最大允许时间之后一个脚本仍然在执行，并且将</div><div class="line"># 开始对查询进行错误响应。</div><div class="line">#</div><div class="line"># 当一个长时间运行的脚本超过了最大执行时间，只有 SCRIPT KILL 和 SHUTDOWN NOSAVE 两个</div><div class="line"># 命令可用。第一个可以用于停止一个还没有调用写命名的脚本。第二个是关闭服务器唯一方式，当</div><div class="line"># 写命令已经通过脚本开始执行，并且用户不想等到脚本的自然终止。</div><div class="line">#</div><div class="line"># 设置成0或者负值表示不限制执行时间并且没有任何警告</div><div class="line">lua-time-limit 5000</div><div class="line"></div><div class="line">################################## SLOW LOG ###################################</div><div class="line"></div><div class="line"># Redis慢查询日志可以记录超过指定时间的查询。运行时间不包括各种I/O时间，例如：连接客户端，</div><div class="line"># 发送响应数据等，而只计算命令执行的实际时间（这只是线程阻塞而无法同时为其他请求服务的命令执</div><div class="line"># 行阶段）</div><div class="line"># </div><div class="line"># 你可以为慢查询日志配置两个参数:一个指明Redis的超时时间(单位为微秒)来记录超过这个时间的命令</div><div class="line"># 另一个是慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录从队列中移除。</div><div class="line">#</div><div class="line"># 下面的时间单位是微秒，所以1000000就是1秒。注意，负数时间会禁用慢查询日志，而0则会强制记录</div><div class="line"># 所有命令。</div><div class="line">slowlog-log-slower-than 10000</div><div class="line"></div><div class="line"># 这个长度没有限制。只是要主要会消耗内存。你可以通过 SLOWLOG RESET 来回收内存。</div><div class="line">slowlog-max-len 128</div><div class="line"></div><div class="line">############################# Event notification ##############################</div><div class="line"></div><div class="line"># Redis 能通知 Pub/Sub 客户端关于键空间发生的事件</div><div class="line"># 这个功能文档位于http://redis.io/topics/keyspace-events</div><div class="line">#</div><div class="line"># 例如：如果键空间事件通知被开启，并且客户端对 0 号数据库的键 foo 执行 DEL 命令时，将通过</div><div class="line"># Pub/Sub发布两条消息：</div><div class="line"># PUBLISH __keyspace@0__:foo del</div><div class="line"># PUBLISH __keyevent@0__:del foo</div><div class="line">#</div><div class="line"># 可以在下表中选择Redis要通知的事件类型。事件类型由单个字符来标识：</div><div class="line">#</div><div class="line"># K    键空间通知，以__keyspace@&lt;db&gt;__为前缀</div><div class="line"># E    键事件通知，以__keysevent@&lt;db&gt;__为前缀</div><div class="line"># g    DEL , EXPIRE , RENAME 等类型无关的通用命令的通知, ...</div><div class="line"># $    String命令</div><div class="line"># l    List命令</div><div class="line"># s    Set命令</div><div class="line"># h    Hash命令</div><div class="line"># z    有序集合命令</div><div class="line"># x    过期事件（每次key过期时生成）</div><div class="line"># e    驱逐事件（当key在内存满了被清除时生成）</div><div class="line"># A    g$lshzxe的别名，因此”AKE”意味着所有的事件</div><div class="line">#</div><div class="line"># notify-keyspace-events 带一个由0到多个字符组成的字符串参数。空字符串意思是通知被禁用。</div><div class="line">#</div><div class="line"># 例子：启用List和通用事件通知：</div><div class="line"># notify-keyspace-events Elg</div><div class="line">#</div><div class="line"># 例子2：为了获取过期key的通知订阅名字为 __keyevent@__:expired 的频道，用以下配置</div><div class="line"># notify-keyspace-events Ex</div><div class="line">#</div><div class="line"># 默认所用的通知被禁用，因为用户通常不需要该特性，并且该特性会有性能损耗。</div><div class="line"># 注意如果你不指定至少K或E之一，不会发送任何事件。</div><div class="line">notify-keyspace-events &quot;&quot;</div><div class="line"></div><div class="line">############################### ADVANCED CONFIG ###############################</div><div class="line"></div><div class="line"># 当hash只有少量的entry时，并且最大的entry所占空间没有超过指定的限制时，会用一种节省内存的</div><div class="line"># 数据结构来编码。可以通过下面的指令来设定限制</div><div class="line">hash-max-ziplist-entries 512</div><div class="line">hash-max-ziplist-value 64</div><div class="line"></div><div class="line"># 与hash似，数据元素较少的list，可以用另一种方式来编码从而节省大量空间。</div><div class="line"># 这种特殊的方式只有在符合下面限制时才可以用：</div><div class="line">list-max-ziplist-entries 512</div><div class="line">list-max-ziplist-value 64</div><div class="line"></div><div class="line"># set有一种特殊编码的情况：当set数据全是十进制64位有符号整型数字构成的字符串时。</div><div class="line"># 下面这个配置项就是用来设置set使用这种编码来节省内存的最大长度。</div><div class="line">set-max-intset-entries 512</div><div class="line"></div><div class="line"># 与hash和list相似，有序集合也可以用一种特别的编码方式来节省大量空间。</div><div class="line"># 这种编码只适合长度和元素都小于下面限制的有序集合：</div><div class="line">zset-max-ziplist-entries 128</div><div class="line">zset-max-ziplist-value 64</div><div class="line"></div><div class="line"># HyperLogLog sparse representation bytes limit. The limit includes the</div><div class="line"># 16 bytes header. When an HyperLogLog using the sparse representation crosses</div><div class="line"># this limit, it is converted into the dense representation.</div><div class="line">#</div><div class="line"># A value greater than 16000 is totally useless, since at that point the</div><div class="line"># dense representation is more memory efficient.</div><div class="line"># </div><div class="line"># The suggested value is ~ 3000 in order to have the benefits of</div><div class="line"># the space efficient encoding without slowing down too much PFADD,</div><div class="line"># which is O(N) with the sparse encoding. The value can be raised to</div><div class="line"># ~ 10000 when CPU is not a concern, but space is, and the data set is</div><div class="line"># composed of many HyperLogLogs with cardinality in the 0 - 15000 range.</div><div class="line">hll-sparse-max-bytes 3000</div><div class="line"></div><div class="line"># 启用哈希刷新，每100个CPU毫秒会拿出1个毫秒来刷新Redis的主哈希表（顶级键值映射表）。</div><div class="line"># redis所用的哈希表实现（见dict.c）采用延迟哈希刷新机制：你对一个哈希表操作越多，哈希刷新</div><div class="line"># 操作就越频繁；反之，如果服务器是空闲的，那么哈希刷新就不会完成，哈希表就会占用更多的一些</div><div class="line"># 内存而已。</div><div class="line"># </div><div class="line"># 默认是每秒钟进行10次哈希表刷新，用来刷新字典，然后尽快释放内存。</div><div class="line">#</div><div class="line"># 建议：</div><div class="line"># 如果你对延迟比较在意，不能够接受Redis时不时的对请求有2毫秒的延迟的话，就用</div><div class="line"># &quot;activerehashing no&quot;，如果不太在意延迟而希望尽快释放内存就设置&quot;activerehashing yes&quot;</div><div class="line">activerehashing yes</div><div class="line"></div><div class="line"># 客户端的输出缓冲区的限制，可用于强制断开那些因为某种原因从服务器读取数据的速度不够快的客户端，</div><div class="line"># （一个常见的原因是一个发布/订阅客户端消费消息的速度无法赶上生产它们的速度）</div><div class="line">#</div><div class="line"># 可以对三种不同的客户端设置不同的限制：</div><div class="line"># normal -&gt; 正常客户端</div><div class="line"># slave -&gt; slave和 MONITOR 客户端</div><div class="line"># pubsub -&gt; 至少订阅了一个pubsub channel或pattern的客户端</div><div class="line">#</div><div class="line"># 下面是每个client-output-buffer-limit语法:</div><div class="line"># client-output-buffer-limit &lt;class&gt;&lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</div><div class="line"></div><div class="line"># 一旦达到硬限制客户端会立即被断开，或者达到软限制并持续达到指定的秒数（连续的）。</div><div class="line"># 例如，如果硬限制为32兆字节和软限制为16兆字节/10秒，客户端将会立即断开</div><div class="line"># 如果输出缓冲区的大小达到32兆字节，或客户端达到16兆字节并连续超过了限制10秒，就将断开连接。</div><div class="line">#</div><div class="line"># 默认normal客户端不做限制，因为他们在不主动请求时不接收数据（以推的方式），只有异步客户端</div><div class="line"># 可能会出现请求数据的速度比它可以读取的速度快的场景。</div><div class="line">#</div><div class="line"># pubsub和slave客户端会有一个默认值，因为订阅者和slaves以推的方式来接收数据</div><div class="line">#</div><div class="line"># 把硬限制和软限制都设置为0来禁用该功能</div><div class="line">client-output-buffer-limit normal 0 0 0</div><div class="line">client-output-buffer-limit slave 256mb 64mb 60</div><div class="line">client-output-buffer-limit pubsub 32mb 8mb 60</div><div class="line"></div><div class="line"># Redis调用内部函数来执行许多后台任务，如关闭客户端超时的连接，清除未被请求过的过期Key等等。</div><div class="line">#</div><div class="line"># 不是所有的任务都以相同的频率执行，但Redis依照指定的“hz”值来执行检查任务。</div><div class="line">#</div><div class="line"># 默认情况下，“hz”的被设定为10。提高该值将在Redis空闲时使用更多的CPU时，但同时当有多个key</div><div class="line"># 同时到期会使Redis的反应更灵敏，以及超时可以更精确地处理。</div><div class="line">#</div><div class="line"># 范围是1到500之间，但是值超过100通常不是一个好主意。</div><div class="line"># 大多数用户应该使用10这个默认值，只有在非常低的延迟要求时有必要提高到100。</div><div class="line">hz 10</div><div class="line"></div><div class="line"># 当一个子进程重写AOF文件时，如果启用下面的选项，则文件每生成32M数据会被同步。为了增量式的</div><div class="line"># 写入硬盘并且避免大的延迟高峰这个指令是非常有用的</div><div class="line">aof-rewrite-incremental-fsync yes</div></pre></td></tr></table></figure></section>
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#redis" >
    <span class="tag-code">redis</span>
  </a>

      </div>
    
    
      <div id="comments"></div>
    
  </article>
</main>

<script>
  (function () {
    var url = 'http://yoursite.com/2017/09/14/Redis配置文件/';
    var banner = ''
    if (banner) {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png') 
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      var imageW = $(this).width()
      var imageH = $(this).height()
      
      var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
      zoom = zoom < 1 ? 1 : zoom
      zoom = zoom > 2 ? 2 : zoom
      var transY = (($(window).height() - imageH) / 2).toFixed(2)

      $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
      $('.image-view-wrap').addClass('wrap-active')
      $('.image-view-wrap img').css({
        'width': `${imageW}`,
        'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
      })
      $('html').css('overflow', 'hidden')

      $('.image-view-wrap').on('click', function() {
        $(this).remove()
        $('html').attr('style', '')
      })
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "yanm1ng";
    if (gitmentConfig != "undefined") {
      var gitment = new Gitment({
        id: "Redis配置文件",
        owner: "yanm1ng",
        repo: "yanm1ng.github.io",
        oauth: {
          client_id: "0f87e490e00ee3fd87ef",
          client_secret: "4a9d2b148e7971c2201ad12131ce8bf8159ccd2e"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "en-US"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2017 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine == 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>

  </body>
</html>